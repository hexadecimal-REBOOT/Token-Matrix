<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video-Depth-Anything ONNX Converter</title>
    <link rel="stylesheet" href="static/styles.css" />
  </head>
  <body>
    <header class="app-header">
      <h1>Video-Depth-Anything Checkpoint Converter</h1>
      <p>
        Upload your Video-Depth-Anything checkpoints, inspect their contents, and
        convert them to ONNX for browser/WebAssembly inference.
      </p>
    </header>

    <main class="layout">
      <section class="panel upload-panel">
        <h2>1. Upload Checkpoint Files</h2>
        <div id="dropzone" class="dropzone" role="button" tabindex="0">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path
              d="M12 16a1 1 0 0 1-1-1V7.41L9.7 8.7a1 1 0 0 1-1.4-1.42l3-3a1 1 0 0 1 1.4 0l3 3a1 1 0 1 1-1.4 1.42L13 7.4V15a1 1 0 0 1-1 1Zm7-1a3 3 0 0 1-3 3H8a3 3 0 0 1-3-3 1 1 0 1 1 2 0 1 1 0 0 0 1 1h8a1 1 0 0 0 1-1 1 1 0 0 1 2 0ZM6 20a1 1 0 1 1 0-2h12a1 1 0 0 1 0 2Z"
            />
          </svg>
          <p>Drag &amp; drop folders or files here, or click to browse.</p>
          <p class="hint">Entire checkpoint folders are supported.</p>
          <input
            id="fileInput"
            type="file"
            webkitdirectory
            multiple
            hidden
            aria-label="Upload checkpoint files"
          />
        </div>
        <div class="actions">
          <button id="clearFiles" type="button" class="secondary">Clear Files</button>
        </div>
        <div id="fileSummary" class="file-summary" hidden></div>
        <ul id="fileList" class="file-list" aria-live="polite"></ul>
      </section>

      <section class="panel options-panel">
        <h2>2. Configure Export</h2>
        <form id="configForm" class="config-form">
          <div class="field-group">
            <label for="encoder">Encoder Variant</label>
            <select id="encoder" name="encoder">
              <option value="vits">ViT-Small</option>
              <option value="vitb">ViT-Base</option>
              <option value="vitl" selected>ViT-Large</option>
            </select>
          </div>
          <div class="field-row">
            <label class="field-group">
              <span>Input Height</span>
              <input type="number" id="inputHeight" name="input_height" min="128" step="14" value="518" />
            </label>
            <label class="field-group">
              <span>Input Width</span>
              <input type="number" id="inputWidth" name="input_width" min="128" step="14" value="518" />
            </label>
          </div>
          <div class="field-row">
            <label class="field-group">
              <span>Sequence Length</span>
              <input type="number" id="sequenceLength" name="sequence_length" min="1" max="64" value="32" />
            </label>
            <label class="field-group">
              <span>Batch Size</span>
              <input type="number" id="batchSize" name="batch_size" min="1" max="4" value="1" />
            </label>
          </div>
          <div class="field-group">
            <label for="opset">ONNX Opset Version</label>
            <input type="number" id="opset" name="opset" min="11" max="20" value="17" />
          </div>
          <div class="field-group checkbox">
            <label>
              <input type="checkbox" id="dynamicAxes" name="dynamic_axes" checked />
              Enable dynamic axes for batch, time, height, and width.
            </label>
          </div>
          <div class="field-group checkbox">
            <label>
              <input type="checkbox" id="metricMode" name="metric" />
              Use metric variant checkpoint
            </label>
          </div>
          <button id="convertButton" type="submit" class="primary">Convert to ONNX</button>
        </form>

        <div id="status" class="status" role="status" aria-live="polite"></div>
        <div id="preview" class="preview" hidden>
          <h3>File Preview</h3>
          <pre id="previewContent"></pre>
        </div>
      </section>
    </main>

    <template id="fileRowTemplate">
      <li class="file-item">
        <div>
          <span class="file-name"></span>
          <span class="file-size"></span>
        </div>
        <div class="file-actions">
          <button type="button" class="link-button preview-button">Preview</button>
          <button type="button" class="link-button remove-button">Remove</button>
        </div>
      </li>
    </template>

    <footer class="app-footer">
      <p>
        Need help preparing your repository? Follow the instructions in the README to
        clone Video-Depth-Anything and bundle your checkpoint files before uploading.
      </p>
    </footer>

    <script type="module" src="static/app.js"></script>
  </body>
</html>
